#!/bin/bash

IMAGE="quay.io/travisci/travis-jvm:latest"

# persistent storage to avoid downloading $INTERNET for every run
mkdir -p caches/{.coursier/cache,.ivy2/cache,.sbt/boot}

docker run --memory 3072m \
    -u travis \
    -v $(pwd):/home/travis/http4s \
    -v $(pwd)/caches/.coursier/cache:/home/travis/.coursier/cache \
    -v $(pwd)/caches/.ivy2/cache:/home/travis/.ivy2/cache \
    -v $(pwd)/caches/.sbt/boot:/home/travis/.sbt/boot \
    --workdir /home/travis/http4s \
    "$IMAGE" ./bin/travis-manual
